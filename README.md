# K-Cube (kv): 你的个人知识时光机与云同步中心

你是否曾想过：
- “上周我是怎么思考这个问题的？当时写的草稿在哪里？”
- “糟糕，我不小心把重要的笔记删了，能找回来吗？”
- “我在公司的电脑上写的笔记，怎么才能无缝地在家里笔记本上继续写？”

K-Cube 就是为解决这些问题而生的。它是一个专为知识管理打造的、本地优先的命令行工具，赋予你追踪、回溯和同步每一次知识沉淀的能力。

把它想象成一个**专属于你知识库的“Git”**，但更简单、更专注。

## 核心特性

- **✍️ 本地优先，数据自主**: 你的所有知识都清晰地存储在你的本地文件夹中，你拥有100%的数据主权。我们只在云端做同步和备份。
- **⏱️ 结构化历史，思考有迹可循**: 每一次保存（我们称之为“提交”），你都可以记录下结构化的信息（如`类型`、`摘要`），而不仅仅是一行文字。这让你的思考脉络清晰可见。
- **☁️ 云端同步，多端无缝切换**: 将你的本地知识库安全地同步到云端，并在你的任何设备上恢复它。一处修改，处处同步。
- **🔒 安全可靠，为失误兜底**: 内置强大的恢复机制，无论是误删文件还是想找回某个历史版本，`kv` 都能帮你轻松搞定。
- **🤝 开发者与编辑器友好**: K-Cube 管理的是纯文本文件（尤其是 Markdown），你可以使用任何你喜欢的编辑器（VSCode, Obsidian, Typora 等）进行创作，K-Cube 在后台为你保驾护航。

## K-Cube 是如何工作的？

K-Cube 的工作模式分为两层：

1.  **本地层**: 在你的本地知识库文件夹（我们称之为“保险库” Vault）中，`kv` 命令帮助你创建历史快照 (`commit`)，查看历史 (`log`)，以及从历史中恢复文件 (`restore`)。
2.  **云端层**: 当你配置好云端服务后，`kv sync` 命令会智能地将你的本地历史快照与云端进行双向同步，确保你的所有设备都拥有最新的知识版本。

## 安装

1.  **环境要求**: 确保你的电脑已安装 Python 3.9+ 和 pip。
2.  **克隆项目**: 将本仓库克隆到你的本地。
    ```bash
    git clone <你的仓库地址>
    cd k-cube
    ```
3.  **创建并激活虚拟环境 (强烈推荐)**:
    ```bash
    # 创建 (只需一次)
    python -m venv venv
    
    # 激活 (每次使用前)
    # Windows:
    .\venv\Scripts\activate
    # macOS/Linux:
    source venv/bin/activate
    ```
4.  **安装 K-Cube**:
    ```bash
    pip install -e .
    ```
    这个命令会将 `kv` 安装到你的系统中。只要虚拟环境是激活的，你就可以在任何地方使用它。

## 快速入门：你的第一个知识保险库 (5分钟)

让我们通过一个简单的流程，感受 K-Cube 的魅力。

**1. 初始化你的保险库**
找一个空文件夹，或者新建一个，作为你的第一个知识库。
```bash
mkdir my-first-vault
cd my-first-vault
kv init
```

**2. 创造你的第一个知识点**
```bash
echo "# 我的第一个知识点" > concept.md
```

<!-- 3. 查看状态
看看 K-Cube 是如何看待这个新变化的。
code
Bash
kv status
它会告诉你，发现了一个“未追踪的文件” concept.md。
4. 拍摄第一个“历史快照” (Commit)
我们要把这个新文件存入 K-Cube 的历史长河中。这分为两步：
code
Bash
# 第一步：告诉 kv 我们要追踪这个文件（把它放到“准备区”）
kv add concept.md

# 第二步：正式提交，并留下说明
kv commit -m "创建了关于概念的第一个笔记"
现在，你的第一个历史版本就永久保存下来了！
5. 对知识进行迭代
我们来修改一下文件内容。
code
Bash
echo "## 细节补充" >> concept.md
再次运行 kv status，它会告诉你 concept.md 文件处于“未暂存的变更”状态。
6. 拍摄第二个快照
重复第4步，保存你的新修改。
code
Bash
kv add concept.md
kv commit -m "为概念笔记补充了二级标题"
7. 回溯时光：查看历史
想看看你都做了些什么？
code
Bash
kv log
kv 会像播放时间线一样，用精美的卡片展示出你刚刚的两次提交记录。 -->

**3. 查看状态**
看看 K-Cube 是如何看待这个新变化的。
```bash
kv status
```
它会告诉你，发现了一个“未追踪的文件” concept.md。
**4. 拍摄第一个“历史快照” (Commit)**
我们要把这个新文件存入 K-Cube 的历史长河中。这分为
两步：
```bash
# 第一步：告诉 kv 我们要追踪这个文件（把它放到“准备区”）
kv add concept.md
# 第二步：正式提交，并留下说明
kv commit -m "创建了关于概念的第一个笔记"
```
现在，你的第一个历史版本就永久保存下来了！
**5. 对知识进行迭代**
我们来修改一下文件内容。
```bash
echo "## 细节补充" >> concept.md
```
再次运行 kv status，它会告诉你 concept.md 文件处于“未暂存的变
更”状态。
**6. 拍摄第二个快照**
重复第4步，保存你的新修改。
```bash
kv add concept.md
kv commit -m "为概念笔记补充了二级标题"
```
**7. 回溯时光：查看历史**
想看看你都做了些什么？
```bash
kv log
```
kv 会像播放时间线一样，用精美的卡片展示出你刚刚的
两次提交记录。

<!-- 云端同步：连接你的所有设备
这是 K-Cube 的核心能力。假设你想把 my-first-vault 同步到你的另一台电脑上。
场景：从设备A 推送到云端，再从设备B 拉取
在设备A上 (你刚刚操作的电脑):
1. 连接到远程服务器
首先，你需要告诉 kv 你的云端服务器地址在哪里。
code
Bash
# 假设你的服务器地址是 http://127.0.0.1:5000 (我们本地测试的地址)
kv remote http://127.0.0.1:5000
2. 登录你的云端账户
code
Bash
kv login
根据提示输入你的邮箱和密码。
3. 执行同步
code
Bash
kv sync
kv 会智能地发现你本地有两个云端没有的版本，并将它们推送上去。
在设备B上 (你的另一台电脑):
1. 准备一个空文件夹
code
Bash
mkdir my-synced-vault
cd my-synced-vault
2. 初始化并连接到云端 (同设备A的步骤1和2)
code
Bash
kv init
kv remote http://127.0.0.1:5000
kv login
3. 执行同步
code
Bash
kv sync
kv 会发现云端有两个本地没有的版本，并将这些“历史胶片”下载到你本地的 .kcube 文件夹中。
4. 恢复文件
同步完成后，工作区还是空的。我们需要从刚下载的历史中恢复文件。
code
Bash
# 首先，查看同步下来的历史记录，找到最新的版本哈希
kv log

# 假设最新的版本哈希是 a1b2c3d...
kv restore a1b2c3d
检查你的 my-synced-vault 文件夹，你会发现 concept.md 文件已经原封不动地出现了！你已经成功实现了知识的跨设备同步。
命令参考手册
kv init
在当前目录初始化一个新的 K-Cube 保险库。
kv status
显示工作区的变更状态。输出分为三个部分，清晰明了：
待提交的变更 (Changes to be committed): 已经使用 kv add 暂存，等待 kv commit 的变更。
未暂存的变更 (Changes not staged for commit): 这些是已追踪文件的修改或删除，需要 kv add 来暂存。
未追踪的文件 (Untracked files): 这些是保险库不认识的新文件，需要 kv add 来开始追踪。
kv add <路径...>
将一个或多个文件/目录的变更添加到暂存区（准备区）。
kv commit
将暂存区的所有变更创建一个新的版本快照（历史记录点）。
-m, --message <摘要>: 直接提供提交摘要，跳过交互式提问。
交互式提交: 如果不带 -m，kv 会引导你输入本次提交的类型 (如 Feat, Fix, Doc)、摘要和关联知识点，帮助你养成结构化记录的好习惯。
kv log [文件路径]
以卡片式时间线的形式显示版本历史。可选择性地只看某个文件的历史。
kv restore <版本> [文件路径]
这是你的“后悔药”和“时光机”，非常强大。
恢复单个文件: kv restore a1b2c3d my_note.md
这会将 my_note.md 的内容恢复到 a1b2c3d 版本时的样子，直接覆盖当前文件。
恢复整个工作区 (软模式): kv restore a1b2c3d
这会将所有被追踪的文件恢复到指定版本，但不会删除你本地新增的“未追踪文件”。
恢复整个工作区 (硬模式): kv restore a1b2c3d --hard
[危险操作] 除了恢复文件，还会删除所有当前工作区存在、但在 a1b2c3d 版本中不存在的文件。请谨慎使用！
kv reset [文件路径...]
从暂存区撤销 kv add 的操作，相当于“我反悔了，先不把这个变更放进准备区”。
kv revert <版本>
通过创建一个新的提交来安全地撤销某个历史提交的全部更改。它不会修改历史，而是在历史的顶端添加一个“反向操作”的提交。适用于撤销已经提交的错误。
云同步命令
kv remote <URL>
设置此本地保险库关联的远程仓库 URL。
kv login
登录到你的 K-Cube 云端服务，获取并保存认证凭证。
kv sync
执行一次完整的双向同步。它会自动计算本地与云端的差异，并执行上传和下载操作，以使两端最终的历史记录保持一致。
下一步是什么？
K-Cube 的旅程才刚刚开始。我们正在努力开发更强大的功能，包括：
后台自动同步守护进程: 实现类似 Dropbox 的无感同步体验。
云端 Web 平台: 提供智能搜索、知识图谱可视化、AI 自动摘要等高级功能。 -->

## 云端同步：连接你的所有设备
这是 K-Cube 的核心能力。假设你想把 my-first-vault 同步到你的另一台电脑上。
场景：从设备A 推送到云端，再从设备B 拉取
在设备A上 (你刚刚操作的电脑):
1. 连接到远程服务器
2. 首先，你需要告诉 kv 你的云端服务器地址在哪里。
```bash
# 假设你的服务器地址是 http://127.0.0.1:5000 (我们本地测试的地址)
kv remote http://127.0.0.1:5000
```
3. 登录你的云端账户
```bash
kv login
```
根据提示输入你的邮箱和密码。
4. 执行同步
```bash
kv sync
```
kv 会智能地发现你本地有两个云端没有的版本，并将它们
推送上去。
在设备B上 (你的另一台电脑):
1. 准备一个空文件夹
```bash
mkdir my-synced-vault
cd my-synced-vault
```
2. 初始化并连接到云端 (同设备A的步骤1和2)
```bash
kv init
kv remote http://127.0.0.1:5000
kv login
```
4. 执行同步
```bash
kv sync
```
kv 会发现云端有两个本地没有的版本，并将这些“历史胶片”下载到你本地的 .kcube 文件夹中。
5. 恢复文件
同步完成后，工作区还是空的。我们需要从刚下载的历史中恢复文件。
```bash
# 首先，查看同步下来的历史记录，找到最新的版本哈希  
kv log
```
```bash# 假设最新的版本哈希是 a1b2c3d...  
kv restore a1b2c3d
```
检查你的 my-synced-vault 文件夹，你会发现 concept.md 文件已经原封不动地出现了！你已经成功实现了知识的跨设备同步。
## 命令参考手册
**kv init**
在当前目录初始化一个新的 K-Cube 保险库。
**kv status**
显示工作区的变更状态。输出分为三个部分，清晰明了：
待提交的变更 (Changes to be committed): 已经使用 kv add 暂存，等待 kv commit 的变更。
未暂存的变更 (Changes not staged for commit): 这些是已追踪文件的修改或删除，需要 kv add 来暂存。
未追踪的文件 (Untracked files): 这些是保险库不认识的新文件，需要 kv add 来开始追踪。
**kv add <路径...>**
将一个或多个文件/目录的变更添加到暂存区（准备区）。
**kv commit**
将暂存区的所有变更创建一个新的版本快照（历史记录点）。
-m, --message <摘要>: 直接提供提交摘要，跳过交互式提问。
交互式提交: 如果不带 -m，kv 会引导你输入本次提交的类型 (如 Feat, Fix, Doc)、摘要和关联知识点，帮助你养成结构化记录的好习惯。
**kv log [文件路径]**
以卡片式时间线的形式显示版本历史。可选择性地只看某个文件的历史。
**kv restore <版本> [文件路径]**
这是你的“后悔药”和“时光机”，非常强大。
恢复单个文件: kv restore a1b2c3d my_note.md
这会将 my_note.md 的内容恢复到 a1b2c3d 版本时的样子，直接覆盖当前文件。
恢复整个工作区 (软模式): kv restore a1b2c3d
这会将所有被追踪的文件恢复到指定版本，但不会删除你本地新增的“未追踪文件”。
恢复整个工作区 (硬模式): kv restore a1b2c3d --hard
[危险操作] 除了恢复文件，还会删除所有当前工作区存在、但在 a1b2c3d 版本中不存在的文件。请谨慎使用！
**kv reset [文件路径...]**
从暂存区撤销 kv add 的操作，相当于“我反悔了，先不把这个变更放进准备区”。
**kv revert <版本>**
通过创建一个新的提交来安全地撤销某个历史提交的全部更改。 它不会修改历史，而是在历史的顶端添加一个“反向操作”的提交。 适用于撤销已经提交的错误。
## 云同步命令
**kv remote <URL>**
设置此本地保险库关联的远程仓库 URL。
**kv login**
登录到你的 K-Cube 云端服务，获取并保存认证凭证。
**kv sync**
执行一次完整的双向同步。它会自动计算本地与云端的差异，并执行上传和下载操作，以使两端最终的历史记录保持一致。
## 下一步是什么？
K-Cube 的旅程才刚刚开始。我们正在努力开发更强大的功能，包括：
后台自动同步守护进程: 实现类似 Dropbox 的无感同步体验。
云端 Web 平台: 提供智能搜索、知识图谱可视化、AI 自动摘要等高级功能。
欢迎加入我们的社区，一起见证 K-Cube 的成长！